# LD.Wæ³¢å½¢åˆ†æå¿«é€Ÿå‚è€ƒå¡ç‰‡

## ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
cd myshixun/exp9
gtkwave dump.fst
```

## ğŸ“ å…³é”®ä¿¡å·è·¯å¾„ï¼ˆåœ¨GTKWaveä¸­ï¼‰

### å¿…é¡»æ·»åŠ çš„ä¿¡å·ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰

#### â­â­â­ æœ€é«˜ä¼˜å…ˆçº§
```
TOP.soc_lite_top.cpu.exe_stage.es_to_ds_load_op          # LoadæŒ‡ä»¤æ ‡å¿—
TOP.soc_lite_top.cpu.exe_stage.es_to_ds_dest[4:0]        # è¦å†™çš„å¯„å­˜å™¨
TOP.soc_lite_top.cpu.hazard_u.load_use_hazard            # Load-Useå†²çª
TOP.soc_lite_top.cpu.hazard_u.block_id                    # IDé˜»å¡ä¿¡å·
TOP.soc_lite_top.cpu.hazard_u.block_if                    # IFé˜»å¡ä¿¡å·
TOP.soc_lite_top.cpu.mem_stage.mem_forward_valid          # MEMå‰é€’æœ‰æ•ˆ
TOP.soc_lite_top.cpu.mem_stage.mem_forward_data[31:0]    # MEMå‰é€’æ•°æ®
```

#### â­â­ é«˜ä¼˜å…ˆçº§
```
TOP.soc_lite_top.cpu.id_stage.ds_valid                   # IDæœ‰æ•ˆ
TOP.soc_lite_top.cpu.id_stage.id_raddr1[4:0]             # IDè¯»å¯„å­˜å™¨1
TOP.soc_lite_top.cpu.id_stage.id_raddr2[4:0]             # IDè¯»å¯„å­˜å™¨2
TOP.soc_lite_top.cpu.exe_stage.es_valid                   # EXEæœ‰æ•ˆ
TOP.soc_lite_top.cpu.exe_stage.es_alu_result[31:0]       # å†…å­˜åœ°å€
TOP.soc_lite_top.cpu.mem_stage.ms_valid                   # MEMæœ‰æ•ˆ
TOP.soc_lite_top.cpu.mem_stage.data_sram_rdata[31:0]     # å†…å­˜è¯»å–æ•°æ®
```

#### â­ ä¸­ç­‰ä¼˜å…ˆçº§
```
TOP.soc_lite_top.cpu.exe_stage.data_sram_en              # æ•°æ®å†…å­˜ä½¿èƒ½
TOP.soc_lite_top.cpu.exe_stage.data_sram_addr[31:0]      # æ•°æ®å†…å­˜åœ°å€
TOP.soc_lite_top.cpu.id_stage.rj_value[31:0]             # rjå€¼ï¼ˆå‰é€’åï¼‰
TOP.soc_lite_top.cpu.id_stage.rkd_value[31:0]            # rk/rdå€¼ï¼ˆå‰é€’åï¼‰
```

## ğŸ” åˆ†ææ­¥éª¤ï¼ˆ5æ­¥æ³•ï¼‰

### Step 1: å®šä½LD.WæŒ‡ä»¤
- æœç´¢ `es_to_ds_load_op = 1` çš„å‘¨æœŸ
- è®°å½•æ—¶é—´ç‚¹ T1

### Step 2: æ£€æŸ¥å†²çª
- åœ¨ T1+1 å‘¨æœŸï¼ŒæŸ¥çœ‹ `id_raddr1` æˆ– `id_raddr2`
- æ˜¯å¦ç­‰äº `es_to_ds_dest`ï¼Ÿ
- å¦‚æœæ˜¯ â†’ å­˜åœ¨Load-Useå†²çª

### Step 3: è§‚å¯Ÿé˜»å¡
- `load_use_hazard` åº”è¯¥ = 1
- `block_id` åº”è¯¥ = 1
- `block_if` åº”è¯¥ = 1
- `ds_valid` ä¿æŒä¸å˜ï¼ˆä¸æ›´æ–°ï¼‰

### Step 4: è§‚å¯Ÿå‰é€’
- LD.Wè¿›å…¥MEMé˜¶æ®µåï¼ˆT1+2ï¼‰
- `mem_forward_valid` åº”è¯¥ = 1
- `mem_forward_data` = `data_sram_rdata`
- `load_use_hazard` åº”è¯¥ = 0ï¼ˆå†²çªè§£å†³ï¼‰

### Step 5: éªŒè¯è§£é™¤é˜»å¡
- `block_id` åº”è¯¥ = 0
- `block_if` åº”è¯¥ = 0
- IDé˜¶æ®µå¯ä»¥ä½¿ç”¨å‰é€’æ•°æ®

## ğŸ“Š å…¸å‹æ—¶åºå›¾

```
å‘¨æœŸ:    T1      T2      T3      T4      T5
-----------------------------------------------
LD.W:    EXE     MEM     WB      -       -
ä¸‹ä¸€æ¡:  ID      ID      ID      EXE     MEM
         (é˜»å¡)  (é˜»å¡)   (å‰é€’)
         
ä¿¡å·:
load_use_hazard: 0       1       0       0       0
block_id:        0       1       1       0       0
mem_forward_valid:0      1       1       0       0
```

## âœ… æ£€æŸ¥æ¸…å•

åˆ†æLD.Wæ—¶ï¼Œç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š

- [ ] `es_to_ds_load_op = 1` åœ¨EXEé˜¶æ®µ
- [ ] `es_to_ds_dest` æ­£ç¡®ï¼ˆè¦å†™çš„å¯„å­˜å™¨å·ï¼‰
- [ ] `data_sram_en = 1` ä¸” `data_sram_addr` æ­£ç¡®
- [ ] å¦‚æœä¸‹ä¸€æ¡æŒ‡ä»¤éœ€è¦è¯»åŒä¸€å¯„å­˜å™¨ â†’ `load_use_hazard = 1`
- [ ] é˜»å¡æ—¶ï¼š`block_id = 1`, `block_if = 1`
- [ ] MEMé˜¶æ®µï¼š`mem_forward_valid = 1`
- [ ] MEMé˜¶æ®µï¼š`mem_forward_data = data_sram_rdata`
- [ ] é˜»å¡1ä¸ªå‘¨æœŸåè§£é™¤ï¼š`block_id = 0`
- [ ] IDé˜¶æ®µä½¿ç”¨å‰é€’æ•°æ®ï¼š`rj_value = mem_forward_data`

## ğŸ¯ å¸¸è§é—®é¢˜

**Q: æ‰¾ä¸åˆ°ä¿¡å·ï¼Ÿ**
A: ç¡®è®¤è·¯å¾„æ­£ç¡®ï¼Œæ³¨æ„å¤§å°å†™ã€‚åœ¨SSTçª—å£æœç´¢ä¿¡å·åã€‚

**Q: çœ‹ä¸åˆ°é˜»å¡ï¼Ÿ**
A: æ£€æŸ¥æ—¶é—´èŒƒå›´ï¼Œç¡®è®¤ä¿¡å·å·²æ·»åŠ ï¼ŒæŸ¥çœ‹`load_use_hazard`æ˜¯å¦ä¸º1ã€‚

**Q: å‰é€’æ•°æ®ä¸å¯¹ï¼Ÿ**
A: æ£€æŸ¥`mem_forward_valid`å’Œ`mem_forward_addr`ï¼Œç¡®è®¤åœ°å€åŒ¹é…ã€‚

**Q: é˜»å¡å‘¨æœŸæ•°ä¸å¯¹ï¼Ÿ**
A: Load-Useåº”è¯¥é˜»å¡1ä¸ªå‘¨æœŸã€‚å¦‚æœè¶…è¿‡ï¼Œæ£€æŸ¥hazardé€»è¾‘ã€‚

## ğŸ”§ GTKWaveå¿«æ·é”®

- `M` - æ·»åŠ æ ‡è®°ï¼ˆMarkerï¼‰
- `Ctrl+F` - æœç´¢ä¿¡å·
- `Ctrl+W` - ç¼©æ”¾é€‚åº”çª—å£
- `â†` `â†’` - å·¦å³ç§»åŠ¨
- `+` `-` - ç¼©æ”¾
- `F` - æŸ¥æ‰¾ä¸‹ä¸€ä¸ªåŒ¹é…

## ğŸ“ ä¿¡å·å‘½åè§„åˆ™

- `es_*` - EXEé˜¶æ®µä¿¡å·
- `ms_*` - MEMé˜¶æ®µä¿¡å·
- `ds_*` - IDé˜¶æ®µä¿¡å·
- `ws_*` - WBé˜¶æ®µä¿¡å·
- `*_forward_*` - å‰é€’ç›¸å…³ä¿¡å·
- `*_valid` - æœ‰æ•ˆæ ‡å¿—
- `*_dest` - ç›®æ ‡å¯„å­˜å™¨åœ°å€
- `*_raddr*` - è¯»å¯„å­˜å™¨åœ°å€

## ğŸ’¡ åˆ†ææŠ€å·§

1. **ä½¿ç”¨æ ‡è®°**ï¼šåœ¨å…³é”®æ—¶é—´ç‚¹æŒ‰`M`é”®æ·»åŠ æ ‡è®°
2. **åˆ†ç»„æ˜¾ç¤º**ï¼šå°†ç›¸å…³ä¿¡å·æ”¾åœ¨ä¸€èµ·ï¼Œç”¨åˆ†éš”çº¿åˆ†å¼€
3. **åå…­è¿›åˆ¶æ˜¾ç¤º**ï¼šåœ°å€å’Œæ•°æ®ç”¨åå…­è¿›åˆ¶æ›´ç›´è§‚
4. **å¯¹é½æ—¶é—´**ï¼šä½¿ç”¨æ ‡è®°å¯¹é½ä¸åŒä¿¡å·çš„æ—¶é—´ç‚¹
5. **ä¿å­˜é…ç½®**ï¼šä¿å­˜`.gtkw`æ–‡ä»¶ï¼Œä¸‹æ¬¡ç›´æ¥åŠ è½½

---

**æç¤º**ï¼šè¯¦ç»†åˆ†ææ­¥éª¤è¯·å‚è€ƒ `LD_W_æ³¢å½¢åˆ†ææŒ‡å—.md`

